# NHSx Covid-19 Antibody Test at Home Web Service

**This is a currently a Trial Service NOT a Live Service**

> Covid-19 Antibody Test at Home Web Service is a wep based service that will allow registered users to take an at home Covid-19 Antibody test and get a result of whether they test positive or negative for Covid-19 antibodies.

## Technical documentation

Each folder of the project has its own specific README describing its intended purpose, technical documenation, and any relevant information:

- [`api/`](api/README.md)
  - The API which serves as the connection between all the parts of our service.
- [`lib/`](lib/README.md)
  - Code & types shared between mutliple applications
- [`ml/`](ml/README.md)
  - Documentation for the machine learning API & instructions for building the docker images
- [`reviewer-app/`](reviewer-app/README.md)
  - The application for reviewing samples of the results generated by the machine learning for quality assurance.
- [`take-test-app/`](take-test-app/README.md)
  - The application for the person taking the test to use to take a picture and submit their results.
- [`terraform/`](terraform/README.md)
  - The terraform for all applications aside from the `api`, which is a Serverless application.

### Install Dependencies

To install dependent modules.

```bash
yarn install
```

This will also postinstall dependencies in all the other applications.

If you only want to install root dependencies:

```bash
yarn install --ignore-scripts
```

### Running the service locally

**Ensure you have all the required `.env` files for each application**

```bash
yarn dev
```

This will run the following:

- `api` in offline mode on [`http://localhost:4000`](http://localhost:4000)
- `take-test-app` on [`http://localhost:3000`](http://localhost:3000)
- `reviewer-app` on [`http://localhost:3001`](http://localhost:3001)

The page will reload if you make edits.

You will also see any lint errors in the console.

### Running Tests

To run the tests on all applications at once you can run

```bash
yarn test
```

To run them individually, run this from within each project directory.

### CI/CD Pipelines

The test & deployment pipeline uses Github Actions [(https://github.com/features/actions)](https://github.com/features/actions) to build out pipelines, the files for these can be found in [`.github/workflows/`](.github/workflows/).

**Run against pull requests**

There is a build & test pipeline that is run against pull requests, this ensures all the applications can build, and that all tests pass.

**Run against master**

The pipeline that runs on merges to master includes building & testing the repos, once these all pass it subsequently runs the E2E tests on the repos (by deploying to dev) and once these pass it deploys all the applications.








<!--

### Testing the image checks

At the moment we are using a mocked api endpoint for the Machine Learning interpretation of the results. To test the UI handling of these responses there are some special login ids you can use. An id containing 'blur' will return the blurred image response. and id's containing 'over', 'under' and 'overunder' will return the relevant exposure responses. 'nocasette' and 'nodiagnostic' will return the responses for the ML model failing to detect the correct regions in the image.

### Building a production version

Builds the app for production to the `build` folder.

```bash
yarn build
```

The front client for this project was bootstrapped with [Create React App](https://github.com/facebook/create-react-app).
The server side service is hosted on AWS.
It is deployed to AWS utilising Github actions the Serverless framework where we deploy the web client to Cloud Front and the server side backend to API Gateway, Lambda function, DynamoDB and S3 to store images.

In the project **client** directory, you can run:

-->
